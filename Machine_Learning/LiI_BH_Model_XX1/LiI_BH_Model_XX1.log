

******************************
Model Input Parameters
******************************
                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 800
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'

******************************
Structures:
    {'Rocksalt'}

Loss Function
******************************
Regularization: L2
Reference Rocksalt Energy: Born-Haber Experimental
Reference Rocksalt/Wurtzite Parameters: Experiment
Solid Volume at Experimental MP - Weight: 1
Melting Point - Weight: 1
Rocksalt Absolute Lattice Energy - Weight: 1
Rocksalt Lattice Parameter a - Weight: 1
******************************
******************************
No checkpoint files found. Starting new calculation.
|==================================================================================================================================================|
| Iter | Eval   | Objective   | Objective   | BestSoFar   | BestSoFar   |        r0_MM |        r0_XX |   epsilon_MM |   epsilon_XX |     gamma_MX |
|      | result |             | runtime     | (observed)  | (estim.)    |              |              |              |              |              |
|==================================================================================================================================================|
|    1 | Best   |      13.206 |     0.13877 |      13.206 |      13.206 |      0.26467 |      0.14145 |       805.54 |       210.09 |       20.322 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -822.746       -2.232                                         
    1      4     -2733.41            0            1         -208     3.69e+03   
Active inequalities (to within options.ConstraintTolerance = 1e-06):
  lower      upper     ineqlin   ineqnonlin
    1                                 

<a href = "matlab: helpview('optim','local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview('optim','norm_search_direction','CSHelpWindow');">size of the current search direction</a> is less than
twice the value of the <a href = "matlab: helpview('optim','step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the value of the <a href = "matlab: helpview('optim','constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg({'optimlib:nlconst:Exit4basic','fmincon'},{'optimlib:nlconst:Exit4detailed','0.000000e+00','1.000000e-10','0.000000e+00','1.000000e-06'},true,true);;">stopping criteria details</a>>
Completed: LiI Rocksalt BH Geometry Optimization. Time 00:00:59
Final Optimized Energy is -2733.4056192026 kJ/mol
Lattice Parameter a = 2.82842712 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
3.8926E+03
|    2 | Best   |       3.342 |      59.723 |       3.342 |       3.342 |      0.12184 |      0.10088 |       346.63 |       397.26 |       23.533 |
|    3 | Accept |      20.606 |     0.15126 |       3.342 |       3.342 |      0.13586 |       0.1427 |       349.94 |       841.01 |       9.5841 |
|    4 | Accept |      9.4966 |     0.16457 |       3.342 |       3.342 |      0.13767 |      0.29074 |       967.19 |       455.22 |       34.972 |
|    5 | Accept |      24.401 |     0.16416 |       3.342 |       3.342 |      0.37146 |      0.43559 |       201.64 |       943.38 |        13.07 |
|    6 | Accept |      26.331 |     0.16391 |       3.342 |       3.342 |      0.38575 |      0.46911 |       920.07 |        719.4 |        44.78 |
|    7 | Accept |       13.05 |     0.14121 |       3.342 |       3.342 |      0.25423 |      0.45197 |       764.27 |       77.774 |       9.2459 |
|    8 | Accept |      12.905 |     0.14379 |       3.342 |       3.342 |      0.18001 |      0.44016 |       551.33 |       682.82 |       29.676 |
|    9 | Accept |      27.742 |     0.14789 |       3.342 |       3.342 |       0.1882 |      0.20564 |       493.76 |        149.3 |       6.2799 |
|   10 | Accept |      9.9824 |     0.14032 |       3.342 |       3.342 |       0.1623 |      0.31717 |       121.73 |       424.15 |       46.465 |
|   11 | Accept |      17.547 |     0.15808 |       3.342 |       3.342 |      0.18947 |      0.36983 |       33.581 |       212.05 |       8.1329 |
|   12 | Accept |      12.006 |     0.14369 |       3.342 |       3.342 |      0.36654 |      0.39631 |        507.3 |       203.45 |       34.142 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -1533.36       -2.232                                         
    1      6     -2574.91       -1.674         0.25    -1.22e+03     2.03e+03   
    2     11     -2780.33       -1.464        0.125    -2.43e+03      5.4e+03  Hessian modified twice  
    3     13     -2780.97        -1.58            1    -2.97e+03     1.74e+03   
    4     15     -2837.12       -1.537            1    -1.74e+03          798   
    5     17     -2842.54       -1.501            1         -798          615   
    6     19     -2846.47       -1.517            1         -615         88.2   
    7     21     -2846.56       -1.515            1        -88.2          8.3   
    8     23     -2846.56       -1.515            1         -8.3        0.137   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:01:37
Final Optimized Energy is -2846.5646914745 kJ/mol
Lattice Parameter a = 4.97043000 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
-1.3699E-01
|   13 | Accept |      3.4482 |      97.734 |       3.342 |       3.342 |      0.20012 |      0.30377 |       234.31 |       156.74 |       43.173 |
|   14 | Accept |      32.244 |     0.14247 |       3.342 |       3.342 |      0.15046 |      0.31147 |       908.98 |       873.73 |       6.4011 |
|   15 | Accept |      29.768 |     0.14447 |       3.342 |       3.342 |      0.39981 |      0.27472 |       493.22 |       194.07 |       6.4932 |
|   16 | Accept |      23.667 |     0.14843 |       3.342 |       3.342 |      0.35362 |      0.22413 |       577.31 |        670.4 |       40.957 |
|   17 | Accept |       13.26 |     0.14638 |       3.342 |       3.342 |      0.15245 |      0.43028 |       348.44 |       745.72 |       24.516 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -1657.88       -2.232                                         
    1      5     -5146.02       -1.116          0.5    -1.39e+03     4.06e+03   
    2     11     -5167.72       -1.162       0.0625    -2.67e+03     1.35e+03   
    3     13      -5180.2       -1.146            1    -1.35e+03          244   
    4     15     -5180.57       -1.143            1         -244         30.1   
    5     17     -5180.57       -1.143            1        -30.1        0.605   
    6     19     -5180.57       -1.143            1       -0.605      0.00189   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:01:26
Final Optimized Energy is -5180.5737549154 kJ/mol
Lattice Parameter a = 4.44516494 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
1.8879E-03
|   18 | Accept |      5.4524 |      86.889 |       3.342 |       3.342 |      0.14195 |      0.30876 |       734.95 |       203.56 |       32.861 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -826.159       -2.232                                         
    1      4     -2921.73            0            1         -213     2.72e+03   
Active inequalities (to within options.ConstraintTolerance = 1e-06):
  lower      upper     ineqlin   ineqnonlin
    1                                 

<a href = "matlab: helpview('optim','local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview('optim','norm_search_direction','CSHelpWindow');">size of the current search direction</a> is less than
twice the value of the <a href = "matlab: helpview('optim','step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the value of the <a href = "matlab: helpview('optim','constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg({'optimlib:nlconst:Exit4basic','fmincon'},{'optimlib:nlconst:Exit4detailed','0.000000e+00','1.000000e-10','0.000000e+00','1.000000e-06'},true,true);;">stopping criteria details</a>>
Completed: LiI Rocksalt BH Geometry Optimization. Time 00:01:09
Final Optimized Energy is -2921.7342759233 kJ/mol
Lattice Parameter a = 2.82842712 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
2.9272E+03
|   19 | Accept |       3.564 |      69.761 |       3.342 |       3.342 |      0.16626 |      0.11194 |       67.313 |       296.83 |        31.21 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -1111.38       -2.232                                         
    1      5     -2986.57       -1.116          0.5         -618     3.34e+03   
    2      8     -5538.27      -0.5579          0.5    -3.96e+03     1.25e+04  Hessian modified twice  
    3     12     -5613.36      -0.6531         0.25     -8.5e+03     4.13e+03   
    4     14     -5707.35      -0.6219            1    -4.13e+03     1.71e+03   
    5     16     -5718.58      -0.5999            1    -1.71e+03          830   
    6     18     -5721.19      -0.6071            1         -830         90.9   
    7     20     -5721.22      -0.6064            1        -90.9         4.24   
    8     22     -5721.22      -0.6063            1        -4.24       0.0257   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:02:39
Final Optimized Energy is -5721.2210582668 kJ/mol
Lattice Parameter a = 3.68589181 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
-2.5747E-02
<a href="matlab: opentoline('C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\Machine_Learning\LiX_Minimizer.m',1168,1)">1168 </a>        Settings.Ref_Density = 1/(Settings.Minimization_Data{strmatch}.V*(0.1^3));
Settings.Geometry
{Unrecognized field name "Geometry".
} 
Settings.Geometry = Default_Crystal(Settings,'Center_Coordinates',true)

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 1
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]

Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 5.96
             b: 5.96
             c: 5.96
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

Settings.Structure

ans =

    'Rocksalt'

    Settings.Structure = Settings.Finite_T_Data.Structure;
    Settings.Geometry = Default_Crystal(Settings,'Center_Coordinates',true)

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 1
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]

Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 5.96
             b: 5.96
             c: 5.96
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

Settings.Minimization_Data{strmatch}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         LJSR: -4403.77238203671
       CoulSR: -1006.66389584883
       CoulLR: -310.784780381276
          Pot: -5721.22105826682
    CoulSR_MM: 3727.18904617039
      LJSR_MM: -153.180642951733
    CoulSR_MX: -8461.0419881895
      LJSR_MX: -2765.63877803779
    CoulSR_XX: 3727.18904617039
      LJSR_XX: -1484.95296104719
      N_atoms: 18522
            a: 3.68589181226593
            b: 3.68589181226593
            c: 3.68589181226593
     FC_Metal: [4×3 double]
    FC_Halide: [4×3 double]
            V: 12.5189458190808
            E: -5721.22105826682
         Salt: 'LiI'
    Structure: 'Rocksalt'
        Model: 'BH'

Settings.Geometry = Default_Crystal(Settings,'Center_Coordinates',true)

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 1
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]

Settings.Minimization_Data{strmatch}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         LJSR: -4403.77238203671
       CoulSR: -1006.66389584883
       CoulLR: -310.784780381276
          Pot: -5721.22105826682
    CoulSR_MM: 3727.18904617039
      LJSR_MM: -153.180642951733
    CoulSR_MX: -8461.0419881895
      LJSR_MX: -2765.63877803779
    CoulSR_XX: 3727.18904617039
      LJSR_XX: -1484.95296104719
      N_atoms: 18522
            a: 3.68589181226593
            b: 3.68589181226593
            c: 3.68589181226593
     FC_Metal: [4×3 double]
    FC_Halide: [4×3 double]
            V: 12.5189458190808
            E: -5721.22105826682
         Salt: 'LiI'
    Structure: 'Rocksalt'
        Model: 'BH'

 Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 5.96
             b: 5.96
             c: 5.96
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

if system_dependent('IsDebugMode')==1, dbquit all; end
delete all
[Warning: File 'all' not found.] 
close all
Bayesian_Optimize_Local_Submit
Unable to load intermediate bayesian optimization data.
Attempting to load backup step.
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -826.159       -2.232                                         
    1      4     -2921.73            0            1         -213     2.72e+03   
Active inequalities (to within options.ConstraintTolerance = 1e-06):
  lower      upper     ineqlin   ineqnonlin
    1                                 

<a href = "matlab: helpview('optim','local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview('optim','norm_search_direction','CSHelpWindow');">size of the current search direction</a> is less than
twice the value of the <a href = "matlab: helpview('optim','step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the value of the <a href = "matlab: helpview('optim','constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg({'optimlib:nlconst:Exit4basic','fmincon'},{'optimlib:nlconst:Exit4detailed','0.000000e+00','1.000000e-10','0.000000e+00','1.000000e-06'},true,true);;">stopping criteria details</a>>
Completed: LiI Rocksalt BH Geometry Optimization. Time 00:00:57
Final Optimized Energy is -2921.7342759233 kJ/mol
Lattice Parameter a = 2.82842712 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
2.9272E+03
|   19 | Accept |       3.564 |      57.813 |       3.342 |       3.342 |      0.16626 |      0.11194 |       67.313 |       296.83 |        31.21 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -1111.38       -2.232                                         
    1      5     -2986.57       -1.116          0.5         -618     3.34e+03   
    2      8     -5538.27      -0.5579          0.5    -3.96e+03     1.25e+04  Hessian modified twice  
    3     12     -5613.36      -0.6531         0.25     -8.5e+03     4.13e+03   
    4     14     -5707.35      -0.6219            1    -4.13e+03     1.71e+03   
    5     16     -5718.58      -0.5999            1    -1.71e+03          830   
    6     18     -5721.19      -0.6071            1         -830         90.9   
    7     20     -5721.22      -0.6064            1        -90.9         4.24   
    8     22     -5721.22      -0.6063            1        -4.24       0.0257   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:02:13
Final Optimized Energy is -5721.2210582668 kJ/mol
Lattice Parameter a = 3.68589181 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
-2.5747E-02
|   20 | Accept |      5.7782 |      133.56 |       3.342 |       3.342 |      0.15334 |      0.22265 |       414.96 |       430.09 |       31.638 |
|==================================================================================================================================================|
| Iter | Eval   | Objective   | Objective   | BestSoFar   | BestSoFar   |        r0_MM |        r0_XX |   epsilon_MM |   epsilon_XX |     gamma_MX |
|      | result |             | runtime     | (observed)  | (estim.)    |              |              |              |              |              |
|==================================================================================================================================================|
|   21 | Accept |        12.6 |     0.14588 |       3.342 |       3.342 |      0.35453 |      0.11049 |       493.92 |       198.25 |        12.76 |
|   22 | Accept |       13.36 |     0.15509 |       3.342 |       3.342 |       0.3868 |      0.16618 |       958.28 |       386.35 |       36.118 |
|   23 | Accept |      25.684 |     0.15224 |       3.342 |       3.342 |      0.37887 |      0.12695 |       910.29 |       626.28 |        18.41 |
|   24 | Accept |      24.592 |     0.14005 |       3.342 |       3.342 |      0.38658 |      0.32828 |       755.74 |       498.56 |       32.922 |
|   25 | Accept |      25.637 |       0.135 |       3.342 |       3.342 |      0.34152 |      0.42288 |       602.85 |       881.72 |       28.324 |
|   26 | Accept |      26.141 |     0.13953 |       3.342 |       3.342 |      0.36276 |      0.22427 |       981.44 |       615.66 |       9.3616 |
|   27 | Accept |       11.94 |     0.14115 |       3.342 |       3.342 |      0.30321 |      0.37308 |       58.742 |       490.26 |       35.905 |
|   28 | Accept |      12.271 |     0.13936 |       3.342 |       3.342 |      0.20851 |      0.35639 |       524.24 |       568.06 |       36.294 |
|   29 | Accept |      25.322 |     0.13527 |       3.342 |       3.342 |      0.15757 |      0.35286 |          608 |       685.19 |       10.776 |
|   30 | Accept |      13.068 |     0.14092 |       3.342 |       3.342 |      0.10159 |      0.25267 |       367.31 |       987.99 |       29.434 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2      -959.55       -2.232                                         
    1      5      -2033.6       -1.116          0.5         -402     1.75e+03   
    2      8     -4385.46      -0.5579          0.5    -2.15e+03     5.49e+03  Hessian modified twice  
    3     11     -7134.75       -0.279          0.5    -7.63e+03     2.13e+03  Hessian modified twice  
    4     15     -7152.12      -0.2092         0.25    -7.92e+03     2.04e+04  Hessian modified twice  
    5     17     -7294.45      -0.2519            1    -1.25e+04      3.4e+03   
    6     19     -7315.49      -0.2427            1     -3.4e+03     1.12e+03   
    7     21     -7317.63      -0.2382            1    -1.12e+03          184   
    8     23     -7317.68      -0.2389            1         -184         7.87   
    9     25     -7317.68      -0.2388            1        -7.87         0.06   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:04:14
Final Optimized Energy is -7317.6835318666 kJ/mol
Lattice Parameter a = 3.16621098 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
5.9951E-02
|   31 | Accept |      6.5723 |       254.5 |       3.342 |       3.342 |      0.15618 |      0.16381 |       593.91 |       707.34 |       43.028 |
|   32 | Accept |      13.225 |      0.1439 |       3.342 |       3.342 |      0.30456 |      0.14484 |       975.02 |       611.56 |        44.57 |
|   33 | Accept |      13.158 |     0.13906 |       3.342 |       3.342 |      0.23261 |      0.48325 |       516.96 |        770.8 |       45.427 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -1448.79       -2.232                                         
    1      5     -5075.55       -1.116          0.5     -1.1e+03     6.33e+03   
    2     10     -6043.87      -0.9763        0.125    -7.43e+03     7.25e+03  Hessian modified twice  
    3     14     -6111.96      -0.9194         0.25    -4.61e+03     3.68e+03   
    4     16      -6139.9      -0.9447            1    -3.68e+03      1.1e+03   
    5     18     -6143.69      -0.9389            1     -1.1e+03          188   
    6     20      -6143.8      -0.9377            1         -188         12.4   
    7     22      -6143.8      -0.9378            1        -12.4        0.129   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:02:11
Final Optimized Energy is -6143.7964131077 kJ/mol
Lattice Parameter a = 4.15460763 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
1.2852E-01
|   34 | Accept |       6.008 |      131.41 |       3.342 |       3.342 |      0.29228 |      0.12821 |       395.67 |       249.91 |       48.187 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2     -877.012       -2.232                                         
    1      4     -2199.17            0            1         -285     5.11e+04   
    2      8     -2699.97      -0.5548         0.25    -5.08e+04     3.66e+03   
    3     10     -2842.72      -0.5175            1    -3.66e+03     3.99e+03   
    4     13     -4169.86      -0.2587          0.5    -3.99e+03     1.71e+03  Hessian modified twice  
    5     16     -4631.17      -0.1294          0.5     -5.7e+03     6.79e+03  Hessian modified twice  
    6     19     -4635.76      -0.1397          0.5    -1.09e+03          169   
    7     21     -4635.88      -0.1383            1         -169         11.5   
    8     23     -4635.88      -0.1382            1        -11.5        0.117   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:04:18
Final Optimized Energy is -4635.8831177373 kJ/mol
Lattice Parameter a = 3.02392463 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
-1.1733E-01
|   35 | Accept |       5.094 |      258.63 |       3.342 |       3.342 |      0.10607 |      0.20741 |        93.94 |       290.37 |       27.857 |
|   36 | Accept |      21.827 |     0.15145 |       3.342 |       3.342 |      0.35024 |      0.31672 |       368.88 |       792.37 |       42.597 |
|   37 | Accept |      23.885 |     0.14734 |       3.342 |       3.342 |      0.22517 |      0.36258 |       441.59 |       293.35 |       17.335 |
Beginning LiI Rocksalt BH Optimization...

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2      31790.2       -2.232                                         
    1      4     -313.432            0            1    -2.65e+05     2.65e+05   
    2      6     -313.432   -7.207e-05            1        -1.77         1.78   
    3      8     -313.537     -0.05799            1        -1.78         1.84  Hessian modified twice  
    4     11     -422.595       -6.471          0.5        -1.84         51.1  Hessian modified twice  
    5     14     -885.955       -3.236          0.5        -52.7          260  Hessian modified twice  
    6     20      -931.48       -3.033       0.0625         -313          949  Hessian modified twice  
    7     23     -931.838       -3.014          0.5        -49.4         13.5   
    8     25     -931.864       -3.018            1        -13.5        0.911   
    9     27     -931.864       -3.018            1       -0.911       0.0163   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:01:40
Final Optimized Energy is -931.8636645627 kJ/mol
Lattice Parameter a = 7.09668660 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
1.6334E-02
Parallel pool using the 'local' profile is shutting down.
<a href="matlab: opentoline('C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\Machine_Learning\LiX_Minimizer.m',1209,1)">1209 </a>    Sol_Output = Calc_Solid_Properties_at_MP(Settings);
Model_Mismatch

Model_Mismatch =

         0.691134514840946

if system_dependent('IsDebugMode')==1, dbstep in; end
if system_dependent('IsDebugMode')==1, dbstep in; end
*** Separate Equilibration of Solid Selected ***
if system_dependent('IsDebugMode')==1, dbstep in; end
if system_dependent('IsDebugMode')==1, dbquit; end
Bayesian_Optimize_Local_Submit
Unable to load intermediate bayesian optimization data.
Attempting to load backup step.
|   37 | Accept |      23.885 |     0.25956 |       3.342 |       3.342 |      0.22517 |      0.36258 |       441.59 |       293.35 |       17.335 |
Beginning LiI Rocksalt BH Optimization...
Starting parallel pool (parpool) using the 'local' profile ...
Connected to the parallel pool (number of workers: 8).

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2      31790.2       -2.232                                         
    1      4     -313.432            0            1    -2.65e+05     2.65e+05   
    2      6     -313.432   -7.207e-05            1        -1.77         1.78   
    3      8     -313.537     -0.05799            1        -1.78         1.84  Hessian modified twice  
    4     11     -422.595       -6.471          0.5        -1.84         51.1  Hessian modified twice  
    5     14     -885.955       -3.236          0.5        -52.7          260  Hessian modified twice  
    6     20      -931.48       -3.033       0.0625         -313          949  Hessian modified twice  
    7     23     -931.838       -3.014          0.5        -49.4         13.5   
    8     25     -931.864       -3.018            1        -13.5        0.911   
    9     27     -931.864       -3.018            1       -0.911       0.0163   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:02:39
Final Optimized Energy is -931.8636645627 kJ/mol
Lattice Parameter a = 7.09668660 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
1.6334E-02
Parallel pool using the 'local' profile is shutting down.
<a href="matlab: opentoline('C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\Machine_Learning\LiX_Minimizer.m',1209,1)">1209 </a>    Sol_Output = Calc_Solid_Properties_at_MP(Settings);
if system_dependent('IsDebugMode')==1, dbstep in; end
if system_dependent('IsDebugMode')==1, dbstep; end
*** Separate Equilibration of Solid Selected ***
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbquit; end
Bayesian_Optimize_Local_Submit
Unable to load intermediate bayesian optimization data.
Attempting to load backup step.
|   37 | Accept |      23.885 |     0.27285 |       3.342 |       3.342 |      0.22517 |      0.36258 |       441.59 |       293.35 |       17.335 |
Beginning LiI Rocksalt BH Optimization...
Starting parallel pool (parpool) using the 'local' profile ...
Connected to the parallel pool (number of workers: 8).

                                Max     Line search  Directional  First-order 
 Iter F-count        f(x)   constraint   steplength   derivative   optimality Procedure 
    0      2      31790.2       -2.232                                         
    1      4     -313.432            0            1    -2.65e+05     2.65e+05   
    2      6     -313.432   -7.207e-05            1        -1.77         1.78   
    3      8     -313.537     -0.05799            1        -1.78         1.84  Hessian modified twice  
    4     11     -422.595       -6.471          0.5        -1.84         51.1  Hessian modified twice  
    5     14     -885.955       -3.236          0.5        -52.7          260  Hessian modified twice  
    6     20      -931.48       -3.033       0.0625         -313          949  Hessian modified twice  
    7     23     -931.838       -3.014          0.5        -49.4         13.5   
    8     25     -931.864       -3.018            1        -13.5        0.911   
    9     27     -931.864       -3.018            1       -0.911       0.0163   

fmincon stopped by the <a href = "matlab: helpview('optim','msg_output_function','CSHelpWindow');">output or plot function</a>.

Completed: LiI Rocksalt BH Geometry Optimization. Time 00:02:20
Final Optimized Energy is -931.8636645627 kJ/mol
Lattice Parameter a = 7.09668660 Å.
Fractional Coordinates for Li: 
0.25000000 0.25000000 0.25000000
Fractional Coordinates for I: 
0.75000000 0.75000000 0.75000000
Components of Final Gradient:
1.6334E-02
Parallel pool using the 'local' profile is shutting down.
<a href="matlab: opentoline('C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\Machine_Learning\LiX_Minimizer.m',1209,1)">1209 </a>    Sol_Output = Calc_Solid_Properties_at_MP(Settings);
if system_dependent('IsDebugMode')==1, dbstep in; end
   disp('*** Separate Equilibration of Solid Selected ***')
*** Separate Equilibration of Solid Selected ***

    Settings.WorkDir = tempname;
    if ~isfolder(Settings.WorkDir)
        mkdir(Settings.WorkDir)
    end
    
    % Generate unit cell: Unit Cell Filename
    Settings.JobName = [Settings.Theory '_TestModel'];
    Settings.UnitCellFile = fullfile(Settings.WorkDir,[Settings.JobName '_UnitCell.' Settings.CoordType])

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 0
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]
                       Ref_Density: 11.1916240129155
                           WorkDir: 'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e'
                           JobName: 'BH_TestModel'
                      UnitCellFile: 'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e\BH_TestModel_UnitCell.gro'

Settings.UnitCellFile

ans =

    'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e\BH_TestModel_UnitCell.gro'

Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 7.09668660090636
             b: 7.09668660090636
             c: 7.09668660090636
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

Settings.Geometry.AtomNames

ans =

  8×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {'Li'}
    {'Li'}
    {'Li'}
    {'Li'}
    {'I' }
    {'I' }
    {'I' }
    {'I' }

Settings.UnitCellFile

ans =

    'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e\BH_TestModel_UnitCell.gro'

Settings.WorkDir

ans =

    'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e'

Coordinate_Text = SaveGroFile(Settings.UnitCellFile,Settings.Geometry,false)
{Unrecognized field name "res_number".

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('SaveGroFile', 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\LiX_Minimization_scripts\SaveGroFile.m', 8)" style="font-weight:bold">SaveGroFile</a> (<a href="matlab: opentoline('C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\LiX_Minimization_scripts\SaveGroFile.m',8,0)">line 8</a>)
            txt = [txt pad(num2str(Geometry.res_number(jj)),5,'left') ...
} 
Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 7.09668660090636
             b: 7.09668660090636
             c: 7.09668660090636
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

Settings.Use_Conv_cell

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   1

Settings.Structure

ans =

    'Rocksalt'

Settings.Coordinate_File = fullfile(Settings.home,'templates',[upper(Settings.CoordType) '_Templates'],...
            [Settings.Structure '_Primitive.' Settings.CoordType])

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 0
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 0
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]
                       Ref_Density: 11.1916240129155
                           WorkDir: 'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e'
                           JobName: 'BH_TestModel'
                      UnitCellFile: 'C:\Users\Hayden\AppData\Local\Temp\tpd68df84f_1b36_4869_a114_5d861aa91d5e\BH_TestModel_UnitCell.gro'
                   Coordinate_File: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\templates\GRO_Templates\Rocksalt_Primitive.gro'

Coordinate_Text = fileread(Settings.Coordinate_File)

Coordinate_Text =

    '##MET####HAL## Rocksalt Primitive Unit Cell
         2
         0        ##MET##    1   ##MX1##   ##MY1##   ##MZ1##
         0        ##HAL##    2   ##HX1##   ##HY1##   ##HZ1##
       ##V1X##  ##V2Y##  ##V3Z##  ##V1Y##  ##V1Z##  ##V2X##  ##V2Z##  ##V3X##  ##V3Y##
     '

    if strcmp(Settings.CoordType,'gro')
        Met = pad(Settings.Metal,2,'left');
        Hal = pad(Settings.Halide,2,'left');
    elseif strcmp(Settings.CoordType,'g96')
        Met = pad(Settings.Metal,2,'right');
        Hal = pad(Settings.Halide,2,'right');
    end
    Coordinate_Text = strrep(Coordinate_Text,'##MET##',Met);
    Coordinate_Text = strrep(Coordinate_Text,'##HAL##',Hal)

Coordinate_Text =

    'Li I Rocksalt Primitive Unit Cell
         2
         0        Li    1   ##MX1##   ##MY1##   ##MZ1##
         0         I    2   ##HX1##   ##HY1##   ##HZ1##
       ##V1X##  ##V2Y##  ##V3Z##  ##V1Y##  ##V1Z##  ##V2X##  ##V2Z##  ##V3X##  ##V3Y##
     '

Coordinate_Text = AddCartesianCoord(Coordinate_Text,Settings.Geometry,1,false,Settings.CoordType)

Coordinate_Text =

    'Li I Rocksalt Primitive Unit Cell
         2
         0        Li    1   0.177   0.177   0.177
         0         I    2   0.532   0.532   0.532
        0.70967   0.70967   0.70967   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
     '

Settings.Geometry

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          Conv: 1
             a: 7.09668660090636
             b: 7.09668660090636
             c: 7.09668660090636
      FC_Metal: [4×3 double]
     FC_Halide: [4×3 double]
         alpha: 90
          beta: 90
         gamma: 90
             N: 8
     Transform: [3×3 double]
            NF: 4
          Salt: 'LiI'
         Label: 'R'
         Metal: 'Li'
        Halide: 'I'
    SkewFactor: 1
            FC: [8×3 double]
        Skew_a: 1
        Skew_b: 1
        Skew_c: 1
     AtomNames: {8×1 cell}

Coordinate_Text = AddCartesianCoord(Coordinate_Text,Settings.Geometry,1,false,Settings.CoordType)

Coordinate_Text =

    'Li I Rocksalt Primitive Unit Cell
         2
         0        Li    1   0.177   0.177   0.177
         0         I    2   0.532   0.532   0.532
        0.70967   0.70967   0.70967   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
     '

open AddCartesianCoord
open Default_Crystal.m
open Structure_Minimization.m
    disp('*** Separate Equilibration of Solid Selected ***')
*** Separate Equilibration of Solid Selected ***

    Settings.WorkDir = tempname;
    if ~isfolder(Settings.WorkDir)
        mkdir(Settings.WorkDir)
    end
    
    % Generate unit cell: Unit Cell Filename
    Settings.JobName = [Settings.Theory '_TestModel'];
    Settings.UnitCellFile = fullfile(Settings.WorkDir,[Settings.JobName '_UnitCell.' Settings.CoordType]);
    Settings.Coordinate_File = fullfile(Settings.home,'templates',[upper(Settings.CoordType) '_Templates'],...
        [Settings.Structure '.' Settings.CoordType]);
    
    % Save unit cell .gro file into current directory
    Coordinate_Text = fileread(Settings.Coordinate_File);

    % Add Metal and Halide symbols
    if strcmp(Settings.CoordType,'gro')
        Met = pad(Settings.Metal,2,'left');
        Hal = pad(Settings.Halide,2,'left');
    elseif strcmp(Settings.CoordType,'g96')
        Met = pad(Settings.Metal,2,'right');
        Hal = pad(Settings.Halide,2,'right');
    end
    Coordinate_Text = strrep(Coordinate_Text,'##MET##',Met);
    Coordinate_Text = strrep(Coordinate_Text,'##HAL##',Hal);
    Coordinate_Text = AddCartesianCoord(Coordinate_Text,Settings.Geometry,1,false,Settings.CoordType)

Coordinate_Text =

    'Li I Rocksalt Conventional Unit Cell
         8
         0        Li    1   0.177   0.177   0.177
         0        Li    2   0.532   0.532   0.177
         0        Li    3   0.177   0.532   0.532
         0        Li    4   0.532   0.177   0.532
         0         I    5   0.532   0.532   0.532
         0         I    6   0.177   0.177   0.532
         0         I    7   0.532   0.177   0.177
         0         I    8   0.177   0.532   0.177
        0.70967   0.70967   0.70967   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
     '

    fid = fopen(Settings.UnitCellFile,'wt');
    fwrite(fid,regexprep(Coordinate_Text,'\r',''));
    fclose(fid)

ans =

     0

Settings.WorkDir

ans =

    'C:\Users\Hayden\AppData\Local\Temp\tp4c6dd481_792f_483c_92ba_a49e14c251a0'

    La = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer/Settings.Geometry.Skew_a; % nm, the minimum box dimension
    Lb = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer/Settings.Geometry.Skew_b; % nm, the minimum box dimension
    Lc = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer/Settings.Geometry.Skew_c; % nm, the minimum box dimension
La

La =

                       3.6

    La = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_a; % nm, the minimum box dimension
    Lb = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_b; % nm, the minimum box dimension
    Lc = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_c; % nm, the minimum box dimension
    
    Na = ceil(La/(Settings.Geometry.a/10));
    Nb = ceil(Lb/(Settings.Geometry.b/10));
    Nc = ceil(Lc/(Settings.Geometry.c/10))

Nc =

     7

Nb

Nb =

     7

    SuperCellFile = fullfile(WorkDir,['Equil_Sol.' Settings.CoordType]);
{Unrecognized function or variable 'WorkDir'.
} 
    SuperCellFile = fullfile(Settings.WorkDir,['Equil_Sol.' Settings.CoordType]);
    Supercell_command = [Settings.gmx_loc ' genconf -f ' windows2unix(Settings.UnitCellFile) ...
         ' -o ' windows2unix(SuperCellFile) ' -nbox ' num2str(Na) ' ' num2str(Nb) ' ' num2str(Nc)];
    [errcode,output] = system(Supercell_command)

errcode =

     0


output =

    '            :-) GROMACS - gmx genconf, 2019.5 (double precision) (-:
     
                                 GROMACS is written by:
          Emile Apol      Rossen Apostolov      Paul Bauer     Herman J.C. Berendsen
         Par Bjelkmar      Christian Blau   Viacheslav Bolnykh     Kevin Boyd    
      Aldert van Buuren   Rudi van Drunen     Anton Feenstra       Alan Gray     
       Gerrit Groenhof     Anca Hamuraru    Vincent Hindriksen  M. Eric Irrgang  
       Aleksei Iupinov   Christoph Junghans     Joe Jordan     Dimitrios Karkoulis
         Peter Kasson        Jiri Kraus      Carsten Kutzner      Per Larsson    
       Justin A. Lemkul    Viveca Lindahl    Magnus Lundborg     Erik Marklund   
         Pascal Merz     Pieter Meulenhoff    Teemu Murtola       Szilard Pall   
         Sander Pronk      Roland Schulz      Michael Shirts    Alexey Shvetsov  
        Alfons Sijbers     Peter Tieleman      Jon Vincent      Teemu Virolainen 
      Christian Wennberg    Maarten Wolf   
                                and the project leaders:
             Mark Abraham, Berk Hess, Erik Lindahl, and David van der Spoel
     
     Copyright (c) 1991-2000, University of Groningen, The Netherlands.
     Copyright (c) 2001-2018, The GROMACS development team at
     Uppsala University, Stockholm University and
     the Royal Institute of Technology, Sweden.
     check out http://www.gromacs.org for more information.
     
     GROMACS is free software; you can redistribute it and/or modify it
     under the terms of the GNU Lesser General Public License
     as published by the Free Software Foundation; either version 2.1
     of the License, or (at your option) any later version.
     
     GROMACS:      gmx genconf, version 2019.5 (double precision)
     Executable:   /usr/local/gromacs2019_5/bin/gmx_d
     Data prefix:  /usr/local/gromacs2019_5
     Working dir:  /mnt/c/Users/Hayden/Documents/Patey_Lab/ThesisCodeBase/MD_Scripts/MD_Job_Submission
     Command line:
       gmx_d genconf -f /mnt/c/Users/Hayden/AppData/Local/Temp/tp4c6dd481_792f_483c_92ba_a49e14c251a0/BH_TestModel_UnitCell.gro -o /mnt/c/Users/Hayden/AppData/Local/Temp/tp4c6dd481_792f_483c_92ba_a49e14c251a0/Equil_Sol.gro -nbox 7 7 7
     
     
     GROMACS reminds you: "In the End Science Comes Down to Praying" (P. v.d. Berg)
     
     '

Settings.Equilibrate_Solid

ans =

     0

Settings.Equilibrate_Solid=5-
 Settings.Equilibrate_Solid=5-
                              ↑
{Error: Invalid expression. Check for missing or extra characters.
} 
Settings.Equilibrate_Solid=50

Settings = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

                       Submit_Jobs: 1
                         BatchMode: 1
                          Continue: 0
                       JobSettings: [1×1 struct]
                              Salt: 'LiI'
                         Structure: 'Rocksalt'
                     Use_Conv_cell: 1
                  Liquid_Interface: 0
                   Liquid_Fraction: 0.5
                            Theory: 'BH'
                             Model: ''
                        WaterModel: 'SPC/E'
                             JobID: ''
                           N_atoms: 5000
                     Cutoff_Buffer: 1.2
                     Prev_geom_loc: ''
                    Prev_geom_time: []
                    Target_Density: []
                       TF_Paramset: 0
                        Thermostat: 'v-rescale'
                          Target_T: 0
                   Time_Constant_T: 0.2
                        Nsttcouple: 10
                               MDP: [1×1 struct]
                          Barostat: 'Berendsen'
                          Isotropy: 'isotropic'
                          Target_P: 1
                   Time_Constant_P: 1
                        Nstpcouple: 50
              ScaleCompressibility: 1
          UseMoltenCompressibility: 0
                         Annealing: 'no'
                   Annealing_Times: []
                   Annealing_Temps: []
                      Table_Length: 4.01
                         CoordType: 'gro'
                     Output_Coords: 1000
          Output_Coords_Compressed: 0
                   Output_Velocity: 0
                     Output_Forces: 0
                     Calc_Energies: 100
                   Output_Energies: 1000
              Update_NeighbourList: 10
                 Skip_Minimization: 0
                   Find_Min_Params: 1
               Find_Similar_Params: 1
                        Data_Types: 1
                            MinMDP: [1×1 struct]
                  PreEquilibration: 0
                               pbc: 'on'
                        GenCluster: 0
                      Cluster_Frac: 0.5
                         Expand_LP: 1
                     Thermal_Solid: 0
                       Expand_a_SC: 1
                       Expand_b_SC: 1
                       Expand_c_SC: 1
                          Expand_a: 1
                          Expand_b: 1
                          Expand_c: 1
                          c_over_a: 1
                        Manual_Box: 0
                      Manual_Box_a: 1
                      Manual_Box_b: 1
                      Manual_Box_c: 1
                     Manual_Radius: 1
                     Delete_MDPout: 0
                      Delete_MDlog: 0
                    Delete_ConfOut: 0
                        Delete_TPR: 0
                    Delete_Backups: 1
                   Delete_Minimize: 0
                      Delete_Equil: 1
                    Delete_outputs: 0
                      Delete_subms: 0
                        Delete_cpt: 1
                           MaxWarn: 1
                     Top_gen_pairs: 'no'
                       Top_fudgeLJ: 1
                       Top_fudgeQQ: 1
                    Table_StepSize: 0.0005
                              home: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase'
                           project: 'C:\Users\Hayden\Documents\Patey_Lab'
                          computer: 'unbearabull'
                             slurm: 0
                         BO_Models: 'C:\Users\Hayden\Documents\Patey_Lab\BO_Models'
                              qsub: ''
                           passlog: ' ^&^> '
                              pipe: '^|'
                               wsl: 'wsl source ~/.bashrc; '
                        MLModelDir: 'C:\Users\Hayden\Documents\Patey_Lab\Machine_Learning_Structure_Finder\LiX_Structure_Selector_Optimization'
            Project_Directory_Name: 'Melting_Point_Studies'
                         CheckTime: 25
                      MaxCheckTime: 1000
                                T0: 742
                                lb: 500
                                ub: 2000
               MeltFreezeThreshold: 0.25
                    SlopeThreshold: 0.0001
                   MaxMPIterations: 10
                     StepTolerance: 0
                          MaxTDiff: 1
               FinalDensityProfile: 1
                  Delete_T_History: 0
                 Equilibrate_Solid: 50
                Equilibrate_Liquid: 50
                 MinInterfaceWidth: 0.075
                      RefStructure: 'Liquid'
                         Optimizer: 'MPSearcher'
                  ExplorationRatio: 2
              Acquisition_Function: 'expected-improvement-plus'
                     N_Seed_Points: 2
                    KernelFunction: 'ardmatern52'
                   InitialMeshSize: 100
                MeshSizeMultiplier: 2
                 FunctionTolerance: 0
                  BracketThreshold: 5
                       MinStepSize: 1
            UseDerivativeWeighting: 0
                      IgnoreBounds: 0
                  RunPostProcessor: 1
                    SaveTrajectory: 1
              SavePredictionsImage: 1
                      SaveFeatures: 0
                   SavePredictions: 0
                     ML_TimeLength: 21
                       ML_TimeStep: 5
                      TimePerFrame: 5
                                 S: [1×1 struct]
                           CR_Damp: [1×1 struct]
                           C6_Damp: [1×1 struct]
                        GAdjust_MX: [0 0 1]
                        GAdjust_MM: [0 0 1]
                        GAdjust_XX: [0 0 1]
                          Trial_ID: 'XX1'
                        Structures: {'Rocksalt'}
               Restart_Calculation: 1
                        Fix_Charge: 1
                        Additivity: 1
                Additional_MM_Disp: 0
                      SigmaEpsilon: 1
               Additional_Function: [1×1 struct]
                         Fix_Alpha: 0
                            Fix_C8: 0
                        SDMM_Range: [0 1000]
                        SDXX_Range: [0 40]
                        SDMX_Range: [0 40]
                       SDMM2_Range: [0 1000]
                       SD6MM_Range: [0 1000]
                       SD6XX_Range: [0 10]
                       SD6MX_Range: [0 100]
                       SD8MM_Range: [0 1000]
                       SD8XX_Range: [0 20]
                       SD8MX_Range: [0 200]
                      SRTFMM_Range: [0.1 500]
                      SRTFXX_Range: [0.1 20]
                      SRTFMX_Range: [0.1 20]
                        SAMM_Range: [0.1 10]
                        SAXX_Range: [0.1 5]
                        SAMX_Range: [0.1 5]
                        SRMM_Range: [0.3 10]
                        SRXX_Range: [0.3 5]
                        SRMX_Range: [0.3 5]
                       Sr0MM_Range: [0.1 0.4]
                       Sr0XX_Range: [0.1 0.5]
                       Sr0MX_Range: [0.1 0.5]
                      SepsMM_Range: [0 1000]
                      SepsXX_Range: [0 1000]
                      SepsMX_Range: [0 1000]
                      SgamMM_Range: [1 6.85714285714286]
                      SgamXX_Range: [1 6.85714285714286]
                      SgamMX_Range: [1 6.85714285714286]
                    SgamMM_RangeBH: [6 50]
                    SgamXX_RangeBH: [6 50]
                    SgamMX_RangeBH: [6 50]
                           Q_Range: [0.95 1.05]
                           Q_value: 1
                Additional_GAdjust: {}
         Additional_GAdjust_Ranges: {}
                            C6Damp: [1×1 struct]
                            CRDamp: [1×1 struct]
                  Extra_Properties: 1
                      Loss_Options: [1×1 struct]
                       CheckBadFcn: 1
                  MinExpWallHeight: 100
                   MaxRepWellDepth: 0
                  MaxModelMismatch: 0.75
                 BadFcnLossPenalty: 1000
                  initial_opt_type: 'bayesopt'
           Max_Bayesian_Iterations: 800
                MinSurrogatePoints: 20
                 MinSampleDistance: 0.1
                         ShowPlots: 1
                   second_opt_type: 'bayesopt'
          Max_Secondary_Iterations: 200
    Secondary_Acquisition_Function: 'lower-confidence-bound'
        ExplorationRatio_Secondary: 1
           SecondaryKernelFunction: 'ardmatern52'
              Max_Local_Iterations: 1000
                       MaxFunEvals: 100
                  Loss_Convergence: 1e-06
                 Param_Convergence: 0.001
                    final_opt_type: 'fminsearchbnd'
                  switch_final_opt: 1
            Parallel_LiX_Minimizer: 0
               Parallel_Struct_Min: 1
                 Parallel_Bayesopt: 0
                             Metal: 'Li'
                            Halide: 'I'
                    Longest_Cutoff: 1.5
                               gmx: 'wsl source ~/.bashrc; gmx_d'
                           gmx_loc: 'wsl source ~/.bashrc; gmx_d'
                        mdrun_opts: ' -v -ntmpi 8'
                 Minimization_Data: {[1×1 struct]}
                     skip_finite_T: 0
                     Finite_T_Data: [1×1 struct]
                          Geometry: [1×1 struct]
                       Ref_Density: 11.1916240129155
                           WorkDir: 'C:\Users\Hayden\AppData\Local\Temp\tp4c6dd481_792f_483c_92ba_a49e14c251a0'
                           JobName: 'BH_TestModel'
                      UnitCellFile: 'C:\Users\Hayden\AppData\Local\Temp\tp4c6dd481_792f_483c_92ba_a49e14c251a0\BH_TestModel_UnitCell.gro'
                   Coordinate_File: 'C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\templates\GRO_Templates\Rocksalt.gro'

    timesteps = Settings.Equilibrate_Solid/Settings.MDP.dt;
    %Compressibility = Get_Alkali_Halide_Compressibility(Settings.Salt);
    Compressibility = 1e-6;
    tau_p = Settings.MDP.dt; % ps
    tau_t = Settings.MDP.dt; % ps

    nstpcouple = max(round(tau_p/(20*Settings.MDP.dt)),1);
    nsttcouple = max(round(tau_t/(20*Settings.MDP.dt)),1)

nsttcouple =

     1

nstpcouple

nstpcouple =

     1

    disp('*** Separate Equilibration of Solid Selected ***')
*** Separate Equilibration of Solid Selected ***

    Settings.WorkDir = tempname;
    if ~isfolder(Settings.WorkDir)
        mkdir(Settings.WorkDir)
    end
    
    % Generate unit cell: Unit Cell Filename
    Settings.JobName = [Settings.Theory '_TestModel'];
    Settings.UnitCellFile = fullfile(Settings.WorkDir,[Settings.JobName '_UnitCell.' Settings.CoordType]);
    Settings.Coordinate_File = fullfile(Settings.home,'templates',[upper(Settings.CoordType) '_Templates'],...
        [Settings.Structure '.' Settings.CoordType]);
    
    
    Coordinate_Text = fileread(Settings.Coordinate_File);

    % Add Metal and Halide symbols
    if strcmp(Settings.CoordType,'gro')
        Met = pad(Settings.Metal,2,'left');
        Hal = pad(Settings.Halide,2,'left');
    elseif strcmp(Settings.CoordType,'g96')
        Met = pad(Settings.Metal,2,'right');
        Hal = pad(Settings.Halide,2,'right');
    end
    Coordinate_Text = strrep(Coordinate_Text,'##MET##',Met);
    Coordinate_Text = strrep(Coordinate_Text,'##HAL##',Hal);
    Coordinate_Text = AddCartesianCoord(Coordinate_Text,Settings.Geometry,1,false,Settings.CoordType); %input coordinates
    
    % Save unit cell .gro file
    fid = fopen(Settings.UnitCellFile,'wt');
    fwrite(fid,regexprep(Coordinate_Text,'\r',''));
    fclose(fid);
            
    % Generate a box with the structure of interest containing the smallest
    % possible number of atoms for the given cutoff, plus a buffer in case of contraction
    La = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_a; % nm, the minimum box dimension
    Lb = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_b; % nm, the minimum box dimension
    Lc = (2*Settings.Longest_Cutoff)*Settings.Cutoff_Buffer*1.25/Settings.Geometry.Skew_c; % nm, the minimum box dimension
    
    Na = ceil(La/(Settings.Geometry.a/10));
    Nb = ceil(Lb/(Settings.Geometry.b/10));
    Nc = ceil(Lc/(Settings.Geometry.c/10))

Nc =

     7

7*7*7*8

ans =

        2744

    SuperCellFile = fullfile(Settings.WorkDir,['Equil_Sol.' Settings.CoordType]);
    Supercell_command = [Settings.gmx_loc ' genconf -f ' windows2unix(Settings.UnitCellFile) ...
         ' -o ' windows2unix(SuperCellFile) ' -nbox ' num2str(Na) ' ' num2str(Nb) ' ' num2str(Nc)];
    [errcode,output] = system(Supercell_command);
    
    if errcode ~= 0
        disp(output);
        error(['Error creating supercell with genconf. Problem command: ' newline Supercell_command]);
    end
    
    % Set the number of steps
    timesteps = Settings.Equilibrate_Solid/Settings.MDP.dt;
    %Compressibility = Get_Alkali_Halide_Compressibility(Settings.Salt);
    Compressibility = 1e-6;
    tau_p = Settings.MDP.dt; % ps
    tau_t = Settings.MDP.dt; % ps

    nstpcouple = max(round(tau_p/(20*Settings.MDP.dt)),1);
    nsttcouple = max(round(tau_t/(20*Settings.MDP.dt)),1);
abs(Settings.Geometry.a - Settings.Geometry.b)

ans =

     0

abs(Settings.Geometry.a - Settings.Geometry.b) < sqrt(eps) && abs(Settings.Geometry.a - Settings.Geometry.c) < sqrt(eps)

ans =

  <a href="matlab:helpPopup logical" style="font-weight:bold">logical</a>

   1

regexprep(num2str([ones(1,3) zeros(1,3)].*Compressibility),' +',' ')

ans =

    '1e-06 1e-06 1e-06 0 0 0'

        isotropy = 'isotropic';
        ref_p = num2str(Settings.Target_P(1));
        Compresstxt = num2str(Compressibility); % bar^(-1)
Settings.MDP_Template
{Unrecognized field name "MDP_Template".
} 
if system_dependent('IsDebugMode')==1, dbquit all; end
clear
clc
gitload
Syncing ~/ThesisCodeBase with github...
Already up to date.
Sync Complete.
open Calc_Liquid_Properties_at_MP.m
open Calc_Liquid_Properties_at_MP.m
which Calc_Liquid_Properties_at_MP
C:\Users\Hayden\Documents\Patey_Lab\ThesisCodeBase\Machine_Learning\Calc_Liquid_Properties_at_MP.m
